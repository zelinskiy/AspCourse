@using AspCourse.Models.ChatModels;
@model AspCourse.Models.ChatModels.ChatViewModels.IndexViewModel

<script>

    function sendNewTopic() {
        $.post({
            url: "/Chat/AddNewTopic",
            data: {
                NewMessageText: $('#newTopicText').val(),
                NewTopicTitle: $('#newTopicTitle').val(),
            },
            success: function (data) {
                window.location.reload();
                console.log(data);
            }
        });
    }

    function removeTopic(id) {
        $.post({
            url: "/Chat/RemoveTopic/?id=" + id,
            type:"DELETE",
            success: function (data) {
                console.log(data);
                window.location.reload();
            }
        })
    }

</script>
<br /><br />
<p><input class="form-control" placeholder="New Topic Title" type="text" id="newTopicTitle" /></p>
<p><textarea id="newTopicText" cols="100" rows="10" placeholder="Enter Message text here"></textarea></p>
<button class="btn btn-default" onclick="sendNewTopic()">New Topic</button>
<br />


@foreach (Topic t in Model.Topics)
{
    <h2>
        <a href="~/Chat/Topic/@t.Id.ToString()">@t.Title</a>
        @{
            if (Model.IsModer)
            {
                <span style="font-size:12px">
                    <button onclick="removeTopic(@t.Id)">DELETE</button>
                    <button onclick="stickTopic(@t.Id)">STICK</button>
                    <button onclick="closeTopic(@t.Id)">CLOSE</button>
                </span>
            }
        }
    </h2>
}




